<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Mi Espacio Terap√©utico</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --beige:#f7f3ee;
  --lila:#c6b7e2;
  --menta:#bfe6d3;
  --menta-fuerte:#9fd9c1;
  --salmon:#f4b6a8;
  --azul:#b7d8f4;
  --ocre:#f1d18a;
  --texto:#4a4a4a;
}

/* ================== BASE ================== */
body{
  margin:0;
  font-family:system-ui, sans-serif;
  background:var(--beige);
  color:var(--texto);
}

header{
  padding:16px;
  background:linear-gradient(90deg,var(--menta),var(--lila));
  font-weight:600;
}

.tabs{
  display:flex;
  gap:6px;
  padding:10px;
  background:#fff;
  overflow-x:auto;
}

.tab{
  border:none;
  background:var(--menta);
  padding:8px 14px;
  border-radius:20px;
  cursor:pointer;
  white-space:nowrap;
}

.tab.active{
  background:var(--menta-fuerte);
  font-weight:600;
}

.content{
  display:none;
  padding:16px;
}

.content.active{
  display:block;
}

/* ================== PROYECTOS ================== */
.projects-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:12px;
}

.add-project-btn{
  border:none;
  background:var(--menta);
  width:36px;
  height:36px;
  border-radius:50%;
  font-size:20px;
  cursor:pointer;
}

.projects-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(140px,1fr));
  gap:14px;
}

/* carpeta limpia */
.project-folder{
  border-radius:14px;
  padding:20px 10px;
  text-align:center;
  cursor:pointer;
  position:relative;
  font-weight:600;
  box-shadow:0 4px 10px rgba(0,0,0,.05);
}

/* acciones carpeta */
.project-actions{
  position:absolute;
  top:6px;
  right:6px;
  display:flex;
  gap:6px;
}

.project-actions button{
  border:none;
  background:rgba(255,255,255,.7);
  border-radius:6px;
  cursor:pointer;
  font-size:12px;
}

/* colores carpetas */
.folder-rosado{background:#f7c6d9;}
.folder-salmon{background:var(--salmon);}
.folder-lila{background:var(--lila);}
.folder-violeta{background:#b49ddb;}
.folder-menta{background:var(--menta);}
.folder-aguamarina{background:#a8e6e1;}
.folder-azul{background:var(--azul);}
.folder-ocre{background:var(--ocre);}
.folder-beige{background:var(--beige);}

/* ================== SUBVISTA PROYECTO ================== */
.project-view{display:none;}
.project-view.active{display:block;}

.project-view-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px;
  border-radius:14px;
  margin-bottom:14px;
}

.close-project{
  border:none;
  background:none;
  font-size:18px;
  cursor:pointer;
}

/* ================== PENDIENTES ================== */
.task-input{
  width:100%;
  border:none;
  border-bottom:1px solid #ccc;
  padding:6px;
  font-size:14px;
  margin-bottom:10px;
}

.task-row{
  display:flex;
  align-items:center;
  gap:8px;
  margin-bottom:6px;
}

.task-row input[type="text"]{
  border:none;
  background:transparent;
  flex:1;
}

.task-row.done input[type="text"]{
  text-decoration:line-through;
  opacity:.6;
}

.task-row button{
  border:none;
  background:none;
  cursor:pointer;
  font-size:12px;
}

/* ================== SECCIONES ================== */
.project-section{
  background:#fff;
  border-radius:14px;
  padding:14px;
  margin-bottom:14px;
}

/* ================== MODAL ================== */
#projectModal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.35);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:9999;
}

.modal-box{
  background:#fff;
  padding:16px;
  border-radius:14px;
  width:260px;
}
</style>
</head>
<body>

<header>üå± Mi espacio</header>

<div class="tabs">
  <button class="tab active" onclick="openTab('day')">D√≠a</button>
  <button class="tab" onclick="openTab('week')">Semana</button>
  <button class="tab" onclick="openTab('month')">Mes</button>
  <button class="tab" onclick="openTab('semester')">Semestre</button>
  <button class="tab" onclick="openTab('projects')">Proyectos</button>
  <button class="tab" onclick="openTab('health')">Salud</button>
</div>

<!-- ================== D√çA ================== -->
<div id="day" class="content active">
  <div class="day-header">
    <div class="date-nav">
      <button onclick="changeDay(-1)">‚Üê</button>
      <span id="currentDate"></span>
      <button onclick="changeDay(1)">‚Üí</button>
    </div>
  </div>

  <div class="intention">
    Intenci√≥n del d√≠a
    <input type="text" id="dayIntention" style="width:100%;margin-top:6px">
  </div>

  <div id="hours"></div>
</div>

<!-- ================== SEMANA ================== -->
<div id="week" class="content">
  <div class="week-nav">
    <button onclick="changeWeek(-1)">‚Üë</button>
    <strong>Semana</strong>
    <button onclick="changeWeek(1)">‚Üì</button>
  </div>
  <div class="week-grid" id="weekGrid"></div>
</div>

<!-- ================== MES ================== -->
<div id="month" class="content">
  <div id="monthGrid" class="month-grid"></div>
</div>

<!-- ================== SEMESTRE ================== -->
<div id="semester" class="content">
  <div id="semesterView" class="semester"></div>
</div>

<!-- ================== PROYECTOS ================== -->
<div id="projects" class="content">

  <!-- Vista principal -->
  <div id="projectsMain">
    <div class="projects-header">
      <h3>üìÅ Proyectos</h3>
      <button class="add-project-btn" onclick="openProjectModal()">Ôºã</button>
    </div>

    <div class="projects-grid" id="projectsGrid">
      <!-- carpetas -->
    </div>
  </div>

  <!-- Subvista proyecto -->
  <div id="projectView" class="project-view">

    <div class="project-view-header" id="projectViewHeader">
      <strong id="projectTitle"></strong>
      <button class="close-project" onclick="closeProjectView()">‚úñ</button>
    </div>

    <!-- Pendientes -->
    <div class="project-section">
      <h4>‚úÖ Pendientes</h4>

      <input
        type="text"
        class="task-input"
        id="taskInput"
        placeholder="Escribe y presiona Enter">

      <div id="projectTasks"></div>
    </div>

    <!-- Documentos -->
    <div class="project-section">
      <h4>üìÇ Documentos importantes</h4>
      <p style="font-size:12px;color:#777">
        Pr√≥ximamente podr√°s subir archivos (pdf, doc, jpg, etc.)
      </p>
    </div>

    <!-- Kit de marca -->
    <div class="project-section">
      <h4>üé® Kit de marca</h4>
      <ul style="font-size:12px;color:#777">
        <li>Colores de marca</li>
        <li>Tipograf√≠as</li>
        <li>Logo</li>
        <li>Im√°genes</li>
        <li>Banco de temas</li>
      </ul>
    </div>

  </div>
</div>

<!-- ================== MODAL NUEVO / EDITAR PROYECTO ================== -->
<div id="projectModal">
  <div class="modal-box">
    <h4 id="projectModalTitle">Nuevo proyecto</h4>

    <input id="projectName" type="text" placeholder="Nombre del proyecto">

    <label>Color</label>
    <select id="projectColor">
      <option value="rosado">Rosado</option>
      <option value="salmon">Salm√≥n</option>
      <option value="lila">Lila</option>
      <option value="violeta">Violeta</option>
      <option value="menta">Menta</option>
      <option value="aguamarina">Aguamarina</option>
      <option value="azul">Azul</option>
      <option value="ocre">Ocre</option>
      <option value="beige">Beige</option>
    </select>

    <div style="margin-top:10px;text-align:right">
      <button onclick="saveProject()">Guardar</button>
      <button onclick="closeProjectModal()">Cancelar</button>
    </div>
  </div>
</div>

<!-- ================== SALUD ================== -->
<div id="health" class="content">üíö Salud (en desarrollo)</div>
<script>
/* ================== ESTADO GLOBAL ================== */
let projects = JSON.parse(localStorage.getItem("projects") || "[]");
let activeProject = null;
let editingProjectId = null;

/* ================== UTILIDADES ================== */
function saveProjects(){
  localStorage.setItem("projects", JSON.stringify(projects));
}

/* ================== PROYECTOS ================== */
function openProjectModal(project=null){
  projectModal.style.display="flex";

  if(project){
    projectModalTitle.textContent="Editar proyecto";
    projectName.value=project.name;
    projectColor.value=project.color;
    editingProjectId=project.id;
  }else{
    projectModalTitle.textContent="Nuevo proyecto";
    projectName.value="";
    projectColor.value="rosado";
    editingProjectId=null;
  }
}

function closeProjectModal(){
  projectModal.style.display="none";
}

function saveProject(){
  const name=projectName.value.trim();
  const color=projectColor.value;

  if(!name){
    alert("Ponle nombre al proyecto");
    return;
  }

  if(editingProjectId){
    const p=projects.find(p=>p.id===editingProjectId);
    p.name=name;
    p.color=color;
  }else{
    projects.push({
      id:Date.now(),
      name,
      color,
      tasks:[],
      documents:[],
      brandKit:{}
    });
  }

  saveProjects();
  closeProjectModal();
  renderProjects();
}

function deleteProject(id){
  if(!confirm("¬øEliminar este proyecto?")) return;
  projects=projects.filter(p=>p.id!==id);
  saveProjects();
  renderProjects();
}

function renderProjects(){
  projectsGrid.innerHTML="";

  projects.forEach(p=>{
    const div=document.createElement("div");
    div.className=`project-folder folder-${p.color}`;

    div.innerHTML=`
      <div class="project-actions">
        <button onclick="event.stopPropagation();openProjectModal(${JSON.stringify(p).replace(/"/g,'&quot;')})">‚úèÔ∏è</button>
        <button onclick="event.stopPropagation();deleteProject(${p.id})">üóë</button>
      </div>
      <div>${p.name}</div>
    `;

    div.onclick=()=>openProject(p.id);
    projectsGrid.appendChild(div);
  });
}

function openProject(id){
  activeProject=projects.find(p=>p.id===id);
  projectsMain.style.display="none";
  projectView.classList.add("active");
  projectTitle.textContent=activeProject.name;
  projectViewHeader.className=`project-view-header folder-${activeProject.color}`;
  renderTasks();
}

function closeProjectView(){
  projectView.classList.remove("active");
  projectsMain.style.display="block";
  activeProject=null;
}

/* ================== PENDIENTES ================== */
taskInput.addEventListener("keydown",e=>{
  if(e.key==="Enter" && taskInput.value.trim()){
    activeProject.tasks.push({
      text:taskInput.value.trim(),
      done:false
    });
    taskInput.value="";
    saveProjects();
    renderTasks();
  }
});

function renderTasks(){
  projectTasks.innerHTML="";

  activeProject.tasks.forEach((t,idx)=>{
    const row=document.createElement("div");
    row.className="task-row"+(t.done?" done":"");

    row.innerHTML=`
      <input type="checkbox" ${t.done?"checked":""}
        onchange="toggleTask(${idx})">
      <input type="text" value="${t.text}"
        onchange="editTask(${idx},this.value)">
      <button onclick="deleteTask(${idx})">üóë</button>
    `;

    projectTasks.appendChild(row);
  });
}

function toggleTask(idx){
  activeProject.tasks[idx].done=!activeProject.tasks[idx].done;
  saveProjects();
  renderTasks();
}

function editTask(idx,value){
  activeProject.tasks[idx].text=value;
  saveProjects();
}

function deleteTask(idx){
  activeProject.tasks.splice(idx,1);
  saveProjects();
  renderTasks();
}

/* ================== INIT ================== */
renderProjects();
</script>
</body>
</html>
